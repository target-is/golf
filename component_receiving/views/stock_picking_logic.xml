<odoo>




    <!-- ######################################################## -->
    <!-- Add CR Operation Type Field in Picking Form              -->
    <!-- ######################################################## -->
    <record id="view_add_cr_operation_type" model="ir.ui.view">
        <field name="name">component.receiving.add.operation.field</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>

        <field name="arch" type="xml">

            <xpath expr="//field[@name='picking_type_id']" position="after">
                <field name="cr_operation_type_id"
                       string="CR Operation Type"
                       domain="[('id','in', allowed_cr_picking_type_ids)]"
                       invisible="not is_cr_view"/>
            </xpath>

            <xpath expr="//field[@name='picking_type_id']" position="attributes">
                <attribute name="invisible">is_cr_view</attribute>
            </xpath>

        </field>
    </record>
    <!-- إخفاء Component Receiving من شاشة Receipts فقط -->
    <record id="stock.action_picking_tree_incoming" model="ir.actions.act_window">
        <field name="domain">[('is_cr_document', '=', False)]</field>
    </record>


    <!-- ######################################################## -->
    <!-- Component Receiving Action                               -->
    <!-- ######################################################## -->
    <record id="action_component_receiving" model="ir.actions.act_window">
        <field name="name">Component Receiving</field>
        <field name="res_model">stock.picking</field>
        <field name="view_mode">list,form</field>

        <field name="context" eval="{
            'search_default_incoming': 1,
            'is_component_receipt': True
        }"/>

        <!-- عرض فقط CR -->
        <field name="domain">[
            ('is_cr_document', '=', True)
            ]
        </field>

        <field name="views" eval="[
            (ref('stock.vpicktree'), 'list'),
            (ref('stock.view_picking_form'), 'form')
        ]"/>
    </record>

    <menuitem
            id="menu_component_receiving"
            name="Component Receiving"
            parent="stock.menu_stock_transfers"
            action="action_component_receiving"
            sequence="21"
    />

</odoo>
